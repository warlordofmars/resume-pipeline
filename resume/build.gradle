
def buildResume(format, theme) {
    exec {
        commandLine 'hackmyresume', 'build', 'resume.json', 'TO', "build/resume.${format}", '-t', theme
    }
}

task('analyzeResume') {
    doFirst {
        exec {
            commandLine 'hackmyresume', 'analyze', 'resume.json'
        }
    }
}

task('validateResume') {
    doFirst {
        exec {
            commandLine 'hackmyresume', 'validate', 'resume.json'
        }
    }
}

task('buildHtmlResume') {
    mustRunAfter validateResume
    doFirst {
        buildResume('html', 'theme/node_modules/jsonresume-theme-short/')
    }
}

task('buildPdfResume') {
    mustRunAfter validateResume
    doFirst {
        buildResume('pdf', 'theme/node_modules/jsonresume-theme-short/')
    }
}

task('build') {
    dependsOn validateResume, analyzeResume, buildHtmlResume, buildPdfResume
}

task('print') {
    mustRunAfter build
    doFirst {
        exec {
            commandLine 'lp', 'build/resume.pdf'
        }
    }
}

task('deploy') {
    mustRunAfter build
    // dependsOn deployStack
    doFirst {

        exec {
            commandLine 'aws', 's3', 'cp', 'build/resume.html', "s3://${getWebsiteUrl()}/${getHtmlResumeName()}"
        }

        exec {
            commandLine 'open', "https://${getWebsiteUrl()}/${getHtmlResumeName()}"
        }

        exec {
            commandLine 'say', "Take a look at the preview résumé now"
        }
    }
}

deploy.dependsOn(':website:deploy')